---
config:
  theme: redux
  look: handDrawn
  layout: elk
---
flowchart TB
    subgraph subGraph0["Global Infrastructure"]
        Users["ğŸŒ Global Users"]
        GLB["ğŸ”„ Global HTTPS Load Balancer<br>Static IP: x.x.x.x"]
        DNS["ğŸŒ Cloud DNS<br>adm-cdn.pt"]
    end
    subgraph subGraph1["Admin VPC - 10.250.0.0/24"]
        AdminVM["ğŸ–¥ï¸ Admin VM<br>Public IP: X.X.X.X<br>Private IP: 10.250.0.10<br>Type: e2-standard-2"]
    end
    subgraph subGraph2["Streaming Pods 1 - Auto-scaling"]
        Pod11["ğŸ“¹ Streaming Pod 1<br>Daemon Set<br>nginx:alpine"]
        Pod12["ğŸ“¹ Streaming Pod 2<br>Daemon Set<br>nginx:alpine"]
        Pod1N["ğŸ“¹ ... Pod N<br>Daemon Set<br>nginx:alpine"]
    end
    subgraph subGraph3["GKE Cluster 1"]
        Master1["ğŸ›ï¸ Control Plane<br>172.16.1.0/28<br>Private Endpoint"]
        NodePool1["âš™ï¸ Node Pool<br>e2-medium nodes<br>Auto-scaling: 1-3"]
        subGraph2
    end
    subgraph subGraph4["VPC-1 - 10.1.0.0/20"]
        Bastion1["ğŸ”§ Bastion Host 1<br>10.1.x.x<br>Private Only"]
        subGraph3
        Service1["âš–ï¸ K8s Service 1<br>NodePort/LoadBalancer"]
    end
    subgraph subGraph5["Region 1"]
        subGraph4
    end
    subgraph subGraph6["Streaming Pods 2 - Auto-scaling"]
        Pod21["ğŸ“¹ Streaming Pod 1<br>Daemon Set<br>nginx:alpine"]
        Pod22["ğŸ“¹ Streaming Pod 2<br>Daemon Set<br>nginx:alpine"]
        Pod2N["ğŸ“¹ ... Pod N<br>Daemon Set<br>nginx:alpine"]
    end
    subgraph subGraph7["GKE Cluster 2"]
        Master2["ğŸ›ï¸ Control Plane<br>172.16.2.0/28<br>Private Endpoint"]
        NodePool2["âš™ï¸ Node Pool<br>e2-medium nodes<br>Auto-scaling: 1-3"]
        subGraph6
    end
    subgraph subGraph8["VPC-2 - 10.2.0.0/20"]
        Bastion2["ğŸ”§ Bastion Host 2<br>10.2.x.x<br>Private Only"]
        subGraph7
        Service2["âš–ï¸ K8s Service 2<br>NodePort/LoadBalancer"]
    end
    subgraph subGraph9["Region 2"]
        subGraph8
    end
    subgraph subGraph10["Streaming Pods N - Auto-scaling"]
        PodN1["ğŸ“¹ Streaming Pod 1<br>Daemon Set<br>nginx:alpine"]
        PodN2["ğŸ“¹ Streaming Pod 2<br>Daemon Set<br>nginx:alpine"]
        PodNN["ğŸ“¹ ... Pod N<br>Daemon Set<br>nginx:alpine"]
    end
    subgraph subGraph11["GKE Cluster N"]
        MasterN["ğŸ›ï¸ Control Plane<br>172.16.N.0/28<br>Private Endpoint"]
        NodePoolN["âš™ï¸ Node Pool<br>e2-medium nodes<br>Auto-scaling: 1-3"]
        subGraph10
    end
    subgraph subGraph12["VPC-N - 10.N.0.0/20"]
        BastionN["ğŸ”§ Bastion Host N<br>10.N.x.x<br>Private Only"]
        subGraph11
        ServiceN["âš–ï¸ K8s Service N<br>NodePort/LoadBalancer"]
    end
    subgraph subGraph13["Region N"]
        subGraph12
    end
    Users --> DNS
    DNS --> GLB
    GLB --> Service1 & Service2 & ServiceN
    Service1 --> Pod11 & Pod12 & Pod1N
    Service2 --> Pod21 & Pod22 & Pod2N
    ServiceN --> PodN1 & PodN2 & PodNN
    AdminVM -. VPC Peering<br>SSH Tunnel .-> Bastion1 & Bastion2 & BastionN
    Bastion1 -- kubectl<br>Authorized Networks --> Master1
    Bastion2 -- kubectl<br>Authorized Networks --> Master2
    BastionN -- kubectl<br>Authorized Networks --> MasterN
    Master1 -. Node Management .-> NodePool1
    Master2 -. Node Management .-> NodePool2
    MasterN -. Node Management .-> NodePoolN
    NodePool1 -. Pod Scheduling .-> Pod11 & Pod12 & Pod1N
    NodePool2 -. Pod Scheduling .-> Pod21 & Pod22 & Pod2N
    NodePoolN -. Pod Scheduling .-> PodN1 & PodN2 & PodNN
    Users:::public
    GLB:::public
    DNS:::public
    AdminVM:::admin
    Bastion1:::private
    Master1:::private
    Pod11:::streaming
    Pod12:::streaming
    Pod1N:::streaming
    Service1:::public
    Bastion2:::private
    Master2:::private
    Pod21:::streaming
    Pod22:::streaming
    Pod2N:::streaming
    Service2:::public
    BastionN:::private
    MasterN:::private
    PodN1:::streaming
    PodN2:::streaming
    PodNN:::streaming
    ServiceN:::public
    classDef public fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef private fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef streaming fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef admin fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
